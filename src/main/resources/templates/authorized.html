<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Authorized Page</title>
</head>
<body>
<h1>Authorized Page</h1>
<button onclick="showAuthorizedPage()">Authorized Button</button>
<form th:action="@{/logout}" method="post">
    <input type="submit" value="Logout"/>
</form>

<h2>XSS Protection Demo</h2>
<form th:action="@{/authorized/userMessage}" method="post">
    <label for="userInput">Enter a message (try including HTML or script tags):</label><br>
    <textarea id="userInput" name="userInput" rows="4" cols="50"></textarea><br>
    <input type="submit" value="Submit Message">
</form>

<script th:inline="javascript">
    function showAuthorizedPage() {
        if ([[${isAdmin}]]) {
            window.location.href = "/authorized/admin";
        } else {
            alert("You are not authorized to view this page.");
        }
    }
</script>
</body>
</html>